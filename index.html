<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Notes App</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <!-- Firebase CDN -->
  <script src="https://www.gstatic.com/firebasejs/12.1.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.1.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore-compat.js"></script>
  <!-- Quill CDN -->
  <link href="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.snow.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.js"></script>
  <style>
    /* Tailwind CSS utilities extracted and expanded for the app */
    .container { width: 100%; margin-left: auto; margin-right: auto; }
    @media (min-width: 640px) { .container { max-width: 640px; } }
    @media (min-width: 768px) { .container { max-width: 768px; } }
    @media (min-width: 1024px) { .container { max-width: 1024px; } }
    .mx-auto { margin-left: auto; margin-right: auto; }
    .p-4 { padding: 1rem; }
    .p-2 { padding: 0.5rem; }
    .max-w-2xl { max-width: 42rem; }
    .flex { display: flex; }
    .flex-wrap { flex-wrap: wrap; }
    .justify-between { justify-content: space-between; }
    .justify-end { justify-content: flex-end; }
    .items-center { align-items: center; }
    .mb-4 { margin-bottom: 1rem; }
    .mb-2 { margin-bottom: 0.5rem; }
    .mt-4 { margin-top: 1rem; }
    .mt-2 { margin-top: 0.5rem; }
    .mr-4 { margin-right: 1rem; }
    .mr-2 { margin-right: 0.5rem; }
    .ml-2 { margin-left: 0.5rem; }
    .text-2xl { font-size: 1.5rem; line-height: 2rem; }
    .text-xl { font-size: 1.25rem; line-height: 1.75rem; }
    .font-bold { font-weight: 700; }
    .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
    .w-full { width: 100%; }
    .border { border-width: 1px; }
    .rounded { border-radius: 0.25rem; }
    .rounded-full { border-radius: 9999px; }
    .rounded-md { border-radius: 0.375rem; }
    .shadow { box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06); }
    .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
    .min-h-screen { min-height: 100vh; }
    .fixed { position: fixed; }
    .inset-0 { top: 0; right: 0; bottom: 0; left: 0; }
    .bg-opacity-50 { background-opacity: 0.5; }
    .z-50 { z-index: 50; }
    .overflow-auto { overflow: auto; }
    .badge { padding: 0.25rem 0.5rem; font-size: 0.75rem; border-radius: 9999px; margin-right: 0.5rem; margin-bottom: 0.5rem; }
    
    /* Light mode styles */
    .bg-gray-100 { background-color: #f3f4f6; }
    .bg-white { background-color: #ffffff; }
    .bg-gray-200 { background-color: #e5e7eb; }
    .bg-blue-500 { background-color: #3b82f6; }
    .bg-green-500 { background-color: #10b981; }
    .bg-gray-500 { background-color: #6b7280; }
    .bg-red-500 { background-color: #ef4444; }
    .bg-black { background-color: #000000; }
    .text-gray-900 { color: #111827; }
    .text-gray-500 { color: #6b7280; }
    .text-white { color: #ffffff; }
    .text-blue-500 { color: #3b82f6; }
    .text-red-500 { color: #ef4444; }
    .border-gray-300 { border-color: #d1d5db; }
    .hover\:bg-blue-600:hover { background-color: #2563eb; }
    .hover\:bg-green-600:hover { background-color: #059669; }
    .hover\:bg-gray-600:hover { background-color: #4b5563; }
    .hover\:bg-red-600:hover { background-color: #dc2626; }
    .hover\:text-blue-700:hover { color: #1d4ed8; }
    .hover\:text-red-700:hover { color: #b91c1c; }
    .bg-blue-100 { background-color: #dbeafe; }
    .text-blue-800 { color: #1e40af; }

    /* Dark mode styles */
    .dark .dark\:bg-gray-900 { background-color: #111827; }
    .dark .dark\:bg-gray-800 { background-color: #1f2937; }
    .dark .dark\:bg-gray-700 { background-color: #4b5563; }
    .dark .dark\:bg-gray-600 { background-color: #374151; }
    .dark .dark\:text-gray-100 { color: #f3f4f6; }
    .dark .dark\:text-gray-400 { color: #9ca3af; }
    .dark .dark\:border-gray-600 { border-color: #4b5563; }
    .dark .dark\:bg-blue-600 { background-color: #2563eb; }
    .dark .dark\:bg-green-600 { background-color: #059669; }
    .dark .dark\:bg-red-600 { background-color: #dc2626; }
    .dark .dark\:hover\:bg-blue-700:hover { background-color: #1d4ed8; }
    .dark .dark\:hover\:bg-green-700:hover { background-color: #047857; }
    .dark .dark\:hover\:bg-gray-700:hover { background-color: #374151; }
    .dark .dark\:hover\:bg-red-700:hover { background-color: #b91c1c; }
    .dark .dark\:text-blue-400 { color: #60a5fa; }
    .dark .dark\:text-red-400 { color: #f87171; }
    .dark .dark\:hover\:text-blue-300:hover { color: #93c5fd; }
    .dark .dark\:hover\:text-red-300:hover { color: #fca5a5; }
    .dark .dark\:bg-blue-900 { background-color: #1e3a8a; }
    .dark .dark\:text-blue-200 { color: #bfdbfe; }

    /* Quill styles for dark mode */
    .dark .ql-toolbar.ql-snow { background-color: #1f2937; border-color: #4b5563; }
    .dark .ql-container.ql-snow { background-color: #1f2937; border-color: #4b5563; color: #f3f4f6; }
    .dark .ql-editor { color: #f3f4f6; }
    .dark .ql-picker-label { color: #f3f4f6; }
    .dark .ql-stroke { stroke: #f3f4f6; }
    .dark .ql-fill { fill: #f3f4f6; }
  </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen">
  <div id="root"></div>
  <script>
    const { useState, useEffect } = React;

    const NotesApp = () => {
      const [notes, setNotes] = useState([]);
      const [newNoteText, setNewNoteText] = useState('');
      const [newNoteTags, setNewNoteTags] = useState('');
      const [searchQuery, setSearchQuery] = useState('');
      const [editingNoteId, setEditingNoteId] = useState(null);
      const [editingNoteText, setEditingNoteText] = useState('');
      const [editingNoteTags, setEditingNoteTags] = useState('');
      const [darkMode, setDarkMode] = useState(false);
      const [user, setUser] = useState(null);
      const [showAuthModal, setShowAuthModal] = useState(false);
      const [authEmail, setAuthEmail] = useState('');
      const [authPassword, setAuthPassword] = useState('');
      const [isSignup, setIsSignup] = useState(false);
      const [authError, setAuthError] = useState('');

      // Firebase Config - REPLACE WITH YOUR OWN
      const firebaseConfig = {
        apiKey: "AIzaSyDWpdlzUxwamll1d52jzgWEGv76jJGroLI",
        authDomain: "notes-app-94873.firebaseapp.com",
        projectId: "notes-app-94873",
        storageBucket: "notes-app-94873.firebasestorage.app",
        messagingSenderId: "163097107290",
        appId: "1:163097107290:web:e58f432de43d714ae4b163",
        measurementId: "G-QKCQFMZRGJ"
};

      // Initialize Firebase
      if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
      }
      const auth = firebase.auth();
      const db = firebase.firestore();

      // Auth state listener
      useEffect(() => {
        const unsubscribe = auth.onAuthStateChanged((currentUser) => {
          setUser(currentUser);
          if (currentUser) {
            loadCloudNotes(currentUser);
          } else {
            loadLocalNotes();
          }
        });
        return unsubscribe;
      }, []);

      // Load notes from localStorage
      const loadLocalNotes = () => {
        const savedNotes = localStorage.getItem('notes');
        if (savedNotes) {
          setNotes(JSON.parse(savedNotes));
        }
      };

      // Load and sync notes from Firestore
      const loadCloudNotes = (currentUser) => {
        const notesRef = db.collection('users').doc(currentUser.uid).collection('notes');
        notesRef.onSnapshot((snapshot) => {
          const cloudNotes = snapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() }));
          setNotes(cloudNotes);
        });
      };

      // Save notes to localStorage
      useEffect(() => {
        if (!user) {
          localStorage.setItem('notes', JSON.stringify(notes));
        }
      }, [notes, user]);

      // Dark mode preference
      useEffect(() => {
        const savedDarkMode = localStorage.getItem('darkMode');
        if (savedDarkMode) {
          setDarkMode(JSON.parse(savedDarkMode));
        }
      }, []);

      useEffect(() => {
        localStorage.setItem('darkMode', JSON.stringify(darkMode));
        if (darkMode) {
          document.documentElement.classList.add('dark');
        } else {
          document.documentElement.classList.remove('dark');
        }
      }, [darkMode]);

      // Initialize Quill for new note
      useEffect(() => {
        if (document.getElementById('new-note-editor')) {
          const quill = new Quill('#new-note-editor', {
            theme: 'snow',
            modules: {
              toolbar: [
                ['bold', 'italic', 'underline'],
                [{ 'color': [] }],
              ]
            }
          });
          quill.on('text-change', () => {
            setNewNoteText(quill.root.innerHTML);
          });
        }
      }, []);

      // Initialize Quill for editing note
      useEffect(() => {
        if (editingNoteId && document.getElementById(`edit-note-editor-${editingNoteId}`)) {
          const quill = new Quill(`#edit-note-editor-${editingNoteId}`, {
            theme: 'snow',
            modules: {
              toolbar: [
                ['bold', 'italic', 'underline'],
                [{ 'color': [] }],
              ]
            }
          });
          quill.root.innerHTML = editingNoteText;
          quill.on('text-change', () => {
            setEditingNoteText(quill.root.innerHTML);
          });
        }
      }, [editingNoteId]);

      // Add a new note
      const addNote = () => {
        if (newNoteText.trim() === '') return;
        const tags = newNoteTags.split(',').map(tag => tag.trim()).filter(tag => tag);
        const note = {
          text: newNoteText,
          tags,
          timestamp: new Date().toLocaleString(),
        };
        if (user) {
          const notesRef = db.collection('users').doc(user.uid).collection('notes');
          notesRef.add(note);
        } else {
          note.id = Date.now();
          setNotes([note, ...notes]);
        }
        setNewNoteText('');
        setNewNoteTags('');
        const quill = Quill.find(document.getElementById('new-note-editor'));
        if (quill) quill.root.innerHTML = '';
      };

      // Start editing a note
      const startEditing = (note) => {
        setEditingNoteId(note.id);
        setEditingNoteText(note.text);
        setEditingNoteTags(note.tags.join(', '));
      };

      // Save edited note
      const saveEdit = (id) => {
        if (editingNoteText.trim() === '') return;
        const tags = editingNoteTags.split(',').map(tag => tag.trim()).filter(tag => tag);
        const updatedNote = { text: editingNoteText, tags };
        if (user) {
          const notesRef = db.collection('users').doc(user.uid).collection('notes');
          notesRef.doc(id).update(updatedNote);
        } else {
          setNotes(notes.map((note) => note.id === id ? { ...note, ...updatedNote } : note));
        }
        setEditingNoteId(null);
        setEditingNoteText('');
        setEditingNoteTags('');
      };

      // Delete a note
      const deleteNote = (id) => {
        if (user) {
          const notesRef = db.collection('users').doc(user.uid).collection('notes');
          notesRef.doc(id).delete();
        } else {
          setNotes(notes.filter((note) => note.id !== id));
        }
      };

      // Handle authentication
      const handleAuth = () => {
        setAuthError('');
        if (isSignup) {
          auth.createUserWithEmailAndPassword(authEmail, authPassword)
            .then(() => setShowAuthModal(false))
            .catch((error) => setAuthError(error.message));
        } else {
          auth.signInWithEmailAndPassword(authEmail, authPassword)
            .then(() => setShowAuthModal(false))
            .catch((error) => setAuthError(error.message));
        }
      };

      // Logout
      const logout = () => {
        auth.signOut();
      };

      // Filter notes
      const filteredNotes = notes.filter((note) =>
        note.text.toLowerCase().includes(searchQuery.toLowerCase()) ||
        note.tags.some(tag => tag.toLowerCase().includes(searchQuery.toLowerCase()))
      );

      return React.createElement(
        'div',
        { className: 'container mx-auto p-4 max-w-2xl' },
        React.createElement(
          'div',
          { className: 'flex justify-between items-center mb-4' },
          React.createElement('h1', { className: 'text-2xl font-bold' }, 'Notes App 📝'),
          React.createElement(
            'div',
            { className: 'flex items-center' },
            user ? React.createElement(
              'button',
              {
                onClick: logout,
                className: 'mr-4 bg-red-500 text-white p-2 rounded hover:bg-red-600 dark:bg-red-600 dark:hover:bg-red-700',
              },
              'Logout'
            ) : React.createElement(
              'button',
              {
                onClick: () => setShowAuthModal(true),
                className: 'mr-4 bg-blue-500 text-white p-2 rounded hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700',
              },
              'Login/Signup'
            ),
            React.createElement(
              'button',
              {
                onClick: () => setDarkMode(!darkMode),
                className: 'p-2 rounded-full bg-gray-200 dark:bg-gray-700',
              },
              darkMode ? '☀️' : '🌙'
            )
          )
        ),

        // Add Note
        React.createElement(
          'div',
          { className: 'mb-4' },
          React.createElement('div', { id: 'new-note-editor', className: 'border rounded border-gray-300 dark:border-gray-600 mb-2' }),
          React.createElement('input', {
            type: 'text',
            value: newNoteTags,
            onChange: (e) => setNewNoteTags(e.target.value),
            placeholder: 'Tags (comma separated)',
            className: 'w-full p-2 border rounded border-gray-300 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-100 mb-2',
          }),
          React.createElement(
            'button',
            {
              onClick: addNote,
              className: 'w-full bg-blue-500 text-white p-2 rounded hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700',
            },
            'Add Note 📝'
          )
        ),

        // Search Notes
        React.createElement(
          'div',
          { className: 'mb-4' },
          React.createElement('input', {
            type: 'text',
            value: searchQuery,
            onChange: (e) => setSearchQuery(e.target.value),
            placeholder: 'Search notes or tags 🔍',
            className: 'w-full p-2 border rounded border-gray-300 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-100',
          })
        ),

        // Notes List
        React.createElement(
          'div',
          null,
          filteredNotes.length === 0 &&
            React.createElement(
              'p',
              { className: 'text-gray-500 dark:text-gray-400' },
              'No notes found.'
            ),
          filteredNotes.map((note) =>
            React.createElement(
              'div',
              {
                key: note.id,
                className: 'bg-white dark:bg-gray-800 p-4 mb-2 rounded shadow',
              },
              editingNoteId === note.id
                ? React.createElement(
                    'div',
                    null,
                    React.createElement('div', { id: `edit-note-editor-${note.id}`, className: 'border rounded border-gray-300 dark:border-gray-600 mb-2' }),
                    React.createElement('input', {
                      type: 'text',
                      value: editingNoteTags,
                      onChange: (e) => setEditingNoteTags(e.target.value),
                      placeholder: 'Tags (comma separated)',
                      className: 'w-full p-2 border rounded border-gray-300 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-100 mb-2',
                    }),
                    React.createElement(
                      'div',
                      { className: 'flex justify-end mt-2' },
                      React.createElement(
                        'button',
                        {
                          onClick: () => saveEdit(note.id),
                          className: 'bg-green-500 text-white p-2 rounded mr-2 hover:bg-green-600 dark:bg-green-600 dark:hover:bg-green-700',
                        },
                        'Save ✏️'
                      ),
                      React.createElement(
                        'button',
                        {
                          onClick: () => setEditingNoteId(null),
                          className: 'bg-gray-500 text-white p-2 rounded hover:bg-gray-600 dark:bg-gray-600 dark:hover:bg-gray-700',
                        },
                        'Cancel'
                      )
                    )
                  )
                : React.createElement(
                    'div',
                    null,
                    React.createElement('div', { className: 'dark:text-gray-100', dangerouslySetInnerHTML: { __html: note.text } }),
                    React.createElement(
                      'div',
                      { className: 'flex flex-wrap mt-2' },
                      note.tags.map((tag) => React.createElement(
                        'span',
                        { key: tag, className: 'badge bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200' },
                        tag
                      ))
                    ),
                    React.createElement(
                      'p',
                      { className: 'text-sm text-gray-500 dark:text-gray-400 mt-2' },
                      note.timestamp
                    ),
                    React.createElement(
                      'div',
                      { className: 'flex justify-end mt-2' },
                      React.createElement(
                        'button',
                        {
                          onClick: () => startEditing(note),
                          className: 'text-blue-500 mr-4 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300',
                        },
                        'Edit ✏️'
                      ),
                      React.createElement(
                        'button',
                        {
                          onClick: () => deleteNote(note.id),
                          className: 'text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300',
                        },
                        'Delete ❌'
                      )
                    )
                  )
            )
          )
        ),

        // Auth Modal
        showAuthModal && React.createElement(
          'div',
          { className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50' },
          React.createElement(
            'div',
            { className: 'bg-white dark:bg-gray-800 p-4 rounded shadow-lg max-w-sm w-full' },
            React.createElement('h2', { className: 'text-xl font-bold mb-4' }, isSignup ? 'Signup' : 'Login'),
            React.createElement('input', {
              type: 'email',
              value: authEmail,
              onChange: (e) => setAuthEmail(e.target.value),
              placeholder: 'Email',
              className: 'w-full p-2 border rounded border-gray-300 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 mb-2',
            }),
            React.createElement('input', {
              type: 'password',
              value: authPassword,
              onChange: (e) => setAuthPassword(e.target.value),
              placeholder: 'Password',
              className: 'w-full p-2 border rounded border-gray-300 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 mb-2',
            }),
            authError && React.createElement('p', { className: 'text-red-500 mb-2' }, authError),
            React.createElement(
              'button',
              {
                onClick: handleAuth,
                className: 'w-full bg-blue-500 text-white p-2 rounded hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700 mb-2',
              },
              isSignup ? 'Signup' : 'Login'
            ),
            React.createElement(
              'button',
              {
                onClick: () => setIsSignup(!isSignup),
                className: 'w-full text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300',
              },
              isSignup ? 'Switch to Login' : 'Switch to Signup'
            ),
            React.createElement(
              'button',
              {
                onClick: () => setShowAuthModal(false),
                className: 'w-full bg-gray-500 text-white p-2 rounded hover:bg-gray-600 dark:bg-gray-600 dark:hover:bg-gray-700 mt-2',
              },
              'Close'
            )
          )
        )
      );
    };

    ReactDOM.render(React.createElement(NotesApp), document.getElementById('root'));
  </script>
</body>
</html>